<html>
<head>
</head>

  <body>
  </body>

<script>
  const TRANSPARENT_PIXEL = "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";
  let image = TRANSPARENT_PIXEL;
  let track = null;
  let imageCapture = null;
  let interval = 0;

  function start(){
    navigator.mediaDevices.getUserMedia({ audio: false, video: true })
      .then((stream) =>{
        track = stream.getVideoTracks()[0];
        imageCapture = new ImageCapture(track);
        interval = setInterval(capture,100);
      })
      .catch((err) =>{
        console.log("no permission to use VideoCam");
      })
  }

  function stop(){
    clearInterval(interval);
    if(track) track.stop();
    delete track; track = null;
    delete imageCapture; imageCapture = null;
  }

  function capture(){
    imageCapture.takePhoto()
      .then((blob) =>{
        let a = new FileReader();
        a.onload = (e) => {
          image = e.target.result;
        };
        a.readAsDataURL(blob);
      }).catch((error) =>{
      //console.log('takePhoto() error: ', error);
    });
  }

</script>
</html>
